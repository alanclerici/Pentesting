#!/usr/bin/env python3
import argparse
import sys
import subprocess
import inquirer
import re
from termcolor import colored

def ipEsValida(ip):
    # Patrón de expresión regular para validar direcciones IP
    patron_ip = r'^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$'

    # Verificar si la IP coincide con el patrón
    if re.match(patron_ip, ip):
        # Ahora, verifica que cada octeto esté en el rango correcto (0-255)
        octetos = ip.split('.')
        for octeto in octetos:
            if not (0 <= int(octeto) <= 255):
                return False
        return True
    else:
        return False

def getArgs():
    args = argparse.ArgumentParser(description='Interfaz de consola para el escaneo de puertos con NMAP')
    args.add_argument("-i","--ip", dest="ip",required=True, help="IP objetivo (Ej: -i 192.168.0.1)")
    salida = args.parse_args()

    if not ipEsValida(salida.ip):
        print(colored(f"\n[!] Ip no valida\n","red"))
        sys.exit(1)

    return salida.ip

#def escaneo(ip,velocidad):
#    if velocidad=='Rapido':
#        subprocess.run(["sudo","nmap","-sS","--min-rate","5000","--open","-vvv","-n","-Pn","-p-",ip])
#    else:
#        subprocess.run(["nmap",ip,"-p-","--open","-T5","-v","-n"])

def main():
    ip = getArgs()
    questions = [
    inquirer.List('velocidad',
                  message="Seleccionar velocidad:",
                  choices=['Wfuzz', 'Gobuster']),
    ]
    respuesta = inquirer.prompt(questions)
    #escaneo(ip,respuesta['velocidad'])

if __name__ == '__main__':
    main()
